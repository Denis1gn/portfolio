# Анализ и выгрузка данных Центрального Банка России

## Описание проекта


### Цель проекта:
Проект направлен на сбор, обработку и анализ данных Центрального Банка России. 
Первая часть проекта направлена на анализ PDF файлов статистических бюллетеней с целью дальнейшего расчета средневзвешенной стоимости капитала (WACC). 
Вторая часть направлена на выгрузку из базы данных Центрального банка исторической информации об уровне инфляции и ключевой ставки

### Применение проекта:
[Статистический бюллетень Банка России](https://www.cbr.ru/statistics/bbs/)
[База данных Банка России](https://www.cbr.ru/hd_base/)


Проект можно использовать для автоматизации выгрузки необходимых данных из бюллетеня и базы ЦБ РФ.

![alt text](https://github.com/Denis1gn/portfolio/blob/main/Finance/CBR_parsing/key_inflation_plot.png)

![alt text](https://github.com/Denis1gn/portfolio/blob/main/Finance/CBR_parsing/rates_plot.png)

<details>
  <summary>Описание функций проекта</summary>

## Функции для поиска и извлечения таблиц из PDF файлов Статистических бюллетеней
    
### __`find_specific_links`__

Находит ссылки на банковские бюллетени на веб-странице Центрального Банка России (ЦБР).

**Параметры:**
- `url` (str): URL веб-страницы ЦБР, с которой необходимо извлечь ссылки на бюллетени.

**Возвращает:**
- `list`: Список строк, где каждая строка - это полный URL для скачивания конкретного бюллетеня.

### __`download_files`__

Загружает последние n банковских бюллетеней из списка предоставленных ссылок.

**Параметры:**
- `links` (list): Список URL-ссылок на банковские бюллетени, которые необходимо скачать.
- `num_files` (int, по умолчанию 4): Количество файлов, которые нужно скачать.

**Возвращает:**
- Ничего не возвращает. Скачивает файлы и сохраняет их в локальную директорию `downloaded_files`. 

**Примечание:**
Функция проверяет, существует ли уже файл, и если да, то пропускает его скачивание.

### __`find_page_with_phrase`__

Ищет страницу в PDF файле, содержащую заданную фразу.

**Параметры:**
- `file_path` (str): Путь к PDF файлу.
- `pattern` (re.Pattern): Регулярное выражение для поиска фразы.
- `start_page` (int, по умолчанию 88): Начальная страница для поиска.
- `end_page` (int, по умолчанию 105): Конечная страница для поиска.

**Возвращает:**
- `int`: Номер страницы, на которой найдена фраза, или `None`, если фраза не найдена.

### __`extract_table_from_page`__

Извлекает таблицу из указанной страницы PDF файла и обрабатывает данные.

**Параметры:**
- `file_path` (str): Путь к PDF файлу.
- `page_number` (int): Номер страницы, с которой нужно извлечь таблицу.

**Возвращает:**
- `DataFrame`: Обработанная таблица pandas DataFrame, где индексы - это даты в формате "ГГГГ-ММ-01", а значения - процентные ставки, преобразованные в числовой формат.

## Функции для поиска и загрузки данных Центрального банка

### __`load_cbr_data`__

Загружает данные с сайта Центрального Банка России.

**Параметры:**
- `data_type` (str): Тип данных для загрузки (Полученный regular_name из функции scrape_cbr_data).
- `start_date` (str): Начальная дата в формате 'dd.mm.yyyy'.
- `end_date` (str): Конечная дата в формате 'dd.mm.yyyy'.

**Возвращает:**
- `DataFrame`: Таблица pandas DataFrame с загруженными данными.

### __`convert_date`__

Преобразует строку с датой в формат "ГГГГ-ММ-ДД" с использованием регулярных выражений.

**Параметры:**
- `date_str` (str): Строка, содержащая дату в формате "ММ.ГГГГ" или аномальные записи в формате "ММ.ГГГ".

**Описание:**
1. **Стандартное преобразование**: 
    - Если дата соответствует формату "ММ.ГГГГ", извлекаются месяц и год, и возвращается дата в формате "ГГГГ-ММ-01".
2. **Преобразование аномальных записей**: 
    - Если дата соответствует формату "ММ.ГГГ", извлекаются месяц и год, к году добавляется недостающая цифра "2", и возвращается дата в формате "2020-ММ-01".
3. **Возврат исходной строки**: 
    - Если строка не соответствует ни одному из форматов, возвращается исходная строка.

**Возвращает:**
- `str`: Строка даты в формате "ГГГГ-ММ-01" или исходная строка, если она не соответствует ожидаемым форматам.
