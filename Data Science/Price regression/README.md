# Определение рыночной стоимости автомобиля

## О проекте

Мы используем исторические данные, включающие технические характеристики, комплектации и цены автомобилей, чтобы построить модель для определения стоимости авто. 
Ключевые требования заказчика:

- Высокое качество предсказания
- Быстрая скорость предсказания
- Оптимальное время обучения модели

## Результаты проекта

### Этап 1: Загрузка и первичное изучение данных

#### Общая информация:
- Всего строк: 354,369

#### Признаки:
- `DateCrawled` — дата скачивания анкеты
- `VehicleType` — тип автомобильного кузова
- `RegistrationYear` — год регистрации автомобиля
- `Gearbox` — тип коробки передач
- `Power` — мощность (л.с.)
- `Model` — модель автомобиля
- `Kilometer` — пробег (км)
- `RegistrationMonth` — месяц регистрации автомобиля
- `FuelType` — тип топлива
- `Brand` — марка автомобиля
- `Repaired` — была ли машина в ремонте
- `DateCreated` — дата создания анкеты
- `NumberOfPictures` — количество фотографий
- `PostalCode` — почтовый индекс владельца
- `LastSeen` — дата последней активности пользователя

#### Целевой признак:
- `Price` — цена (евро)

#### Обнаруженные проблемы:
- `NumberOfPictures` содержит только нулевые значения, неинформативен
- Аномалии в `RegistrationYear` и `Power`
- Пропуски в `VehicleType`, `Gearbox`, `Model`, `FuelType`, `Repaired`
- 4 полных дубликата

### Этап 2: Предобработка данных

#### Действия:
- Удалены 4 дубликата
- Оставлены автомобили, зарегистрированные между 1960 и 2016 годами
- Удалены неинформативные признаки: `DateCrawled`, `DateCreated`, `LastSeen`, `PostalCode`, `RegistrationMonth`, `Brand`, `RegistrationYear`, `NumberOfPictures`, `RegistrationDate`

### Этап 3: Анализ и корректировка аномалий

#### Количественные признаки:
- Средняя цена: 4416 евро, максимальная: 20000 евро, минимальная: 0 евро (возможная аномалия)
- Мощность: 75% значений менее 143 л.с., много аномалий
- Средний пробег: 128,331 км
- Средний возраст машины: 12.6 лет, присутствуют аномалии с отрицательным возрастом
- Нулевые значения стоимости заменены на медианные
- Убраны аномальные значения в категории мощности
- Исключены наблюдения с отрицательным возрастом

#### Категориальные признаки:
- Дорогие модели авто — SUV, медианная цена 8500 евро
- Самая дорогая модель — `gl`, 19 тысяч евро
- Автоматическая коробка передач дороже ручной: 5500 евро против 2700 евро
- Гибридные автомобили почти вдвое дороже электроавтомобилей
- Машины без ремонта дороже машин после ремонта
- В столбце `FuelType` заменены значения `gasoline` на `petrol`

### Этап 4: Корреляционный анализ

#### Итоги:
- Оставлено 292,123 наблюдений после корректировок
- Оптимизация размера данных: использование памяти сократилось с 12.83 МБ до 7.81 МБ (на 39.1%)
- Корреляционная матрица показывает высокую корреляцию между признаками `lifetime` и `model`, а также умеренную корреляцию между `lifetime` и целевым признаком

### Этап 5: Обучение моделей

#### Результаты:
- Обучение моделей заняло 16 минут
- Лучшая модель: `LGBMRegressor(n_estimators=441, num_leaves=48, random_state=42)`
- Метрика RMSE на лучшей модели: 1548

### Этап 6: Тестирование модели

#### Результаты:
- RMSE на тестовой выборке: 1534, что удовлетворяет требованию заказчика
- Время предсказания: 2.58 сек

### Этап 7: Анализ влияния признаков

![alt text](https://github.com/Denis1gn/portfolio/blob/main/Data%20Science/Price%20regression/SHAP.png)

#### Основные выводы:
- С возрастом автомобиля его стоимость снижается
- Высокая мощность машины повышает цену
- Увеличение пробега снижает цену

Проект успешно завершен, модель отвечает требованиям заказчика по качеству предсказаний, скорости и времени обучения.
